<h3>Задача 1</h3>

Используя docker поднимите инстанс PostgreSQL (версию 13). Данные БД сохраните в volume.

Подключитесь к БД PostgreSQL используя psql.

Воспользуйтесь командой \? для вывода подсказки по имеющимся в psql управляющим командам.

Найдите и приведите управляющие команды для:

- вывода списка БД
- подключения к БД
- вывода списка таблиц
- вывода описания содержимого таблиц
- выхода из psql

Управляющие команды                 | Вывод
----------------------------------- | -------------
вывода списка БД                    | psql -l, --list
подключения к БД                    | psql -d, --dbname=DBNAME (переход между базами \c dbname=user)
вывода списка таблиц                | \dt
вывода описания содержимого таблиц  | \dt[S+]  (\dt+)
выхода из psql                      | \q

___________________________________________________________________________________________________________________________________________________

<h3>Задача 2</h3>

Используя psql создайте БД test_database.

Изучите бэкап БД.

Восстановите бэкап БД в test_database.

```
root@vagrant:~/backup_sql# cat test_dump.sql | docker exec -i pg_docker psql -U postgres -d test_database
SET
SET
SET
SET
SET
 set_config
------------

(1 row)

SET
SET
SET
SET
SET
SET
CREATE TABLE
ALTER TABLE
CREATE SEQUENCE
ALTER TABLE
ALTER SEQUENCE
ALTER TABLE
COPY 8
 setval
--------
      8
(1 row)
```

![alt tag](https://github.com/avo1yanskiy/devops-netology/blob/main/virt-homeworks/6.4/restore.png)


Перейдите в управляющую консоль psql внутри контейнера.


Подключитесь к восстановленной БД и проведите операцию ANALYZE для сбора статистики по таблице.

```
test_database=# ANALYZE VERBOSE orders;
INFO:  analyzing "public.orders"
INFO:  "orders": scanned 1 of 1 pages, containing 8 live rows and 0 dead rows; 8 rows in sample, 8 estimated total rows
ANALYZE
```

Используя таблицу pg_stats, найдите столбец таблицы orders с наибольшим средним значением размера элементов в байтах.
Приведите в ответе команду, которую вы использовали для вычисления и полученный результат.

```
test_database=# select attname, max(avg_width) from pg_stats where schemaname = 'public' and tablename = 'orders' group by attname;
 attname | max
---------+-----
 id      |   4
 price   |   4
 title   |  16
(3 rows)
```


___________________________________________________________________________________________________________________________________________________________


<h3>Задача 3</h3>

Архитектор и администратор БД выяснили, что ваша таблица orders разрослась до невиданных размеров и поиск по ней занимает долгое время. Вам, как успешному выпускнику курсов DevOps в нетологии предложили провести разбиение таблицы на 2 (шардировать на orders_1 - price>499 и orders_2 - price<=499).

Предложите SQL-транзакцию для проведения данной операции.

Можно ли было изначально исключить "ручное" разбиение при проектировании таблицы orders?

__________________________________________________________________________________________________________________________________________________________

<h3>Задача 4</h3>

Используя утилиту pg_dump создайте бекап БД test_database.

Как бы вы доработали бэкап-файл, чтобы добавить уникальность значения столбца title для таблиц test_database?

Открыл бекап файл , нашел title и придал ему уникальность :)

[ТУТ БЕКАП](https://github.com/avo1yanskiy/devops-netology/tree/main/virt-homeworks/6.4)
